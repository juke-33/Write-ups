from sympy.ntheory.modular import crt
from sympy import Integer, root
from Crypto.Util.number import long_to_bytes

# Collected ciphertexts and moduli
ciphertexts = [
    71547295777479273744885187951388841696186867318708378603290323002787652564695103435125734809822994284799491225891841763378376542657129111467898747461224111670590084820487858121997157434563229722020054100369444742222588003127442514737914304650732892761707227736459735018693126202075807561782473438833822233057,
    36781481855695580894723494521690249042588848815812589811174572022033927070328939921904332067772511770782452412228391376055341469915086698452677266871994585499724473887628724507504903741140864592482886683198578404705689339078107703235039865952418451189351176101635325248893480712467149473276906226458741004625,
    38111967453062738409935449888837239218598045882166095976707841757916960836398845418945258696158240675308655089009541770673834958341337952136809370582309255223432671640441136109489465644582075036591671939492989340998100186761168716718613521520652215918051492156245385633775168782808822155958605215814025629444
]
moduli = [
    82506600229294078492652690247350820091249340594336738664054006455656697569891009307456910462965452753361314956651424631509124950559188134066434861597165781925106985596468103643341387230026054770633507100425796997582915349143369988139030338331101121657287269143232930420645749445033866702913979860346588643381,
    124814415133284707998643923592182923426372683146358875716150414298581491239604014673886464627640680448258967010265833732322834696840644592368343211275207421418709070137381953718507264234729377595738282689071027896049185681002731656978673376508440141170581420467013608171874846101151835233334407331165393551499,
    79930197240225016345631521452849059373938261720662129288808644682160840719778726400559815332267088513301244672362388343537316646595136017249305164080654235606247242123654574321294774715549208936251682193376414106660606596912284360946016401512082156206969197180376686940193009230783971355265819297529444651987
]

# Use CRT to find combined modulus and remainder
combined_c, combined_n = crt(moduli, ciphertexts)

# Calculate the integer cube root
m_cubed = Integer(combined_c)
m = root(m_cubed, 3)

# Check if the cube root is exact
if m**3 != m_cubed:
    raise ValueError("The cube root is not exact")

# Convert the message to bytes
plaintext = long_to_bytes(int(m))
print(plaintext.decode())